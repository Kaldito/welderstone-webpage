<!DOCTYPE html>
<html lang="en">
    <%- include('layouts/navbar'); -%>

<head>
    <meta charset="utf-8" />
    <%- include('layouts/metaData'); -%>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <title>Welderstone</title>
    <!-- Favicon-->
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
    <!-- Bootstrap icons-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" rel="stylesheet" />
    <!-- Bootstrap-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <!-- CSS Stylesheet-->
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/habibmhamadi/multi-select-tag/dist/css/multi-select-tag.css">
    <link rel="stylesheet" href="css/style.css">
    <!-- Fontawesome CDN Link -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">

    <!--Imagenes-->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
  // Wrap the code in a document ready event handler
  document.addEventListener("DOMContentLoaded", function () {
    // Get a reference to the checkbox element
    var taxIncludedCheckbox = document.getElementById("taxIncludedProducto");

    // Get references to the elements you want to hide
    var elementsToHide = document.querySelectorAll(
      ".Hide-it , select[name='taxabilityProducto'], select[name='taxesType'], input[name='taxesRate'], input[name='taxesBase'], select[name='taxesFactor'], input[name='taxesWithholding'], input[name='taxesLocalType'], input[name='taxesLocalRate'], input[name='taxesLocalBase'], input[name='taxesLocalWithholding']"
    );

    // Function to toggle the visibility of the elements based on checkbox status
    function toggleElementsVisibility() {
      for (var i = 0; i < elementsToHide.length; i++) {
        elementsToHide[i].style.display = taxIncludedCheckbox.checked ? "none" : "block";
      }
    }

    // Initial setup
    toggleElementsVisibility();

    // Add an event listener to the checkbox to update the visibility when it's checked
    taxIncludedCheckbox.addEventListener("change", toggleElementsVisibility);
  });
</script>
</head>

<body>

        
    <h1 class="titulo"></h1>

        <br>        
        <section id="agregar-producto">

            <div class="accordion" id="accordion-ap">
                <div class="accordion-item">

                    <h2 class="accordion-header" id="headingOne">

                        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                            Crear producto</button>

                    </h2>
                    <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#accordionExample">
                        <div class="accordion-body">
           
                            <form action="/FacturApiCrearProductos" method="post">
                                <div class="form-floating">

                                <input  class="form-control" type="text" id="descriptionProducto" name="descriptionProducto" placeholder=" ">
                                <label for="descriptionProducto">Descripción:</label>

                                </div>
                                <br>
                                <div class="form-floating">

                                <input  class="form-control" type="number" id="keyProducto" name="keyProducto" placeholder=" ">
                                <label for="keyProducto">Clave del Producto:</label>

                            </div>

                                <br>
                                <div class="form-floating">

                                <input  class="form-control" type="number" step="0.01" id="priceProducto" name="priceProducto" placeholder=" ">
                                <label for="priceProducto">Precio:</label>

                            </div>

                                 <br>

                                    <label for="taxIncludedProducto">Impuestos incluidos:</label>
                                <input type="checkbox" id="taxIncludedProducto" name="taxIncludedProducto">
<!--All this must dissapear If I press that checkbox-->
<div class="Hide-it">

                                <br> 
                        <hr>        
                        
                                <h2>Impuestos</h2>
                                <div class="form-floating">

                                <label class="form-control" for="taxabilityProducto">Código de Impuestos:</label>
                                <select  class="form-control" id="taxabilityProducto" name="taxabilityProducto">
                                    <option value="01">01: No objeto de impuesto</option>
                                    <option value="02">02: Sí objeto de impuesto</option>
                                    <option value="03">03: Sí objeto de impuesto, pero no obligado a desglose</option>
                                    <option value="04">04: Sí objeto de impuesto, y no causa impuesto</option>
                                </select>
                                <br>
                            </div>

                                <div class="form-floating">

                                <label class="form-control" for="taxabilityProducto">Tipo de Impuesto:</label>
                                <select  class="form-control" id="taxesType" name="taxesType">
                                    <option value="IVA">IVA</option>
                                    <option value="ISR">ISR</option>
                                    <option value="IEPS">IEPS</option>
                                </select>

                                <br>
                            </div>

                                <div class="form-floating">
                                    <label for="taxesRate">Tasa de Impuesto:</label>

                                <input  class="form-control" type="number" step="0.01" id="taxesRate" name="taxesRate" placeholder=" ">

                            </div>

                                <br>
                                <div class="form-floating">

                                <!-- Para los impuestos 'taxes' -->
                        <input  class="form-control" type="number" step="0.01" id="taxesBase" name="taxesBase" placeholder=" ">
                        <label for="taxesBase">Base de Impuesto:</label>

                        <br>
                    </div>

                        <div class="form-floating">

                        <select  class="form-control" id="taxesFactor" name="taxesFactor">
                            <option value="Tasa">Tasa</option>
                            <option value="Cuota">Cuota</option>
                            <option value="Exento">Exento</option>
                        </select>
                        <label for="taxesFactor">Factor de Impuesto:</label>

                        <br>
                    </div>

                        <div class="form-floating">
                            <label for="taxesWithholding">Retención de Impuesto:</label>
<br>
                        <input  type="checkbox" id="taxesWithholding" name="taxesWithholding">



                    </div>

                        <br><br>

                        <h2>Impuestos locales</h2>
                        <div class="form-floating">

                        <!-- Para los impuestos locales 'local_taxes' -->
                        <input  class="form-control" type="text" id="taxesLocalType" name="taxesLocalType" placeholder=" ">
                        <label for="taxesLocalType">Tipo de Impuesto Local:</label>

                    </div>

                        <br>
                        <div class="form-floating">

                        <input  class="form-control" type="number" step="0.01" id="taxesLocalRate" name="taxesLocalRate" placeholder=" ">
                        <label for="taxesLocalRate">Tasa de Impuesto Local:</label>

                    </div>

                        <br>
                        <div class="form-floating">

                        <input  class="form-control" type="number" step="0.01" id="taxesLocalBase" name="taxesLocalBase" placeholder=" ">
                        <label for="taxesLocalBase">Base de Impuesto Local:</label>

                    </div>

                        <br>
                        <div class="form-floating">


                        <label for="taxesWithholding">Retención de Impuesto:</label>
                        <br>
                        <input  type="checkbox" id="taxesLocalWithholding" name="taxesLocalWithholding">

                    </div>

                        <br>
                        
                                <hr>
                                <br>
                                <div class="form-floating">

                                <input  class="form-control" type="text" id="unitKey" name="unitKey" placeholder=" ">
                                <label for="unitKey">Clave de la Unidad:</label>
                                <a href="https://dashboard.facturapi.io/catalogs/unit?q=carro" target="_blank">?</a>
                                

                            </div>

                                <br>
                                <div class="form-floating">

                                <input  class="form-control" type="text" id="unitName" name="unitName" placeholder=" ">
                                <label for="unitName">Nombre de la Unidad:</label>
                                <a href="https://dashboard.facturapi.io/catalogs/unit?q=carro" target="_blank">?</a>


                            </div>

                                <br>
                                <div class="form-floating">

                                <input  class="form-control" type="text" id="sku" name="sku" placeholder=" ">
                                <label for="sku">Identificador del producto:</label>

                            </div>
                        </div>
                                <br><br>
                                <button class="btn btn-danger" type="submit">Ingresar Producto</button>
                            </form>

                        </div>
                    </div>
                </div>
            </div>
<!--All this must dissapear If I press that checkbox-->

        </section>
<br>

      
        <section id="editar-producto">
            <div class="card-body">
                <div class="mb-4">
                    <form action="/FacturApiBuscarProducto" method="POST">
                        <input type="text" id="nombreProductoInput" name="NombreABuscar" aria-label="Buscar el nombre del producto" class="form-control espec1" placeholder="Ingresa el nombre del producto" class="form-control">
                        <br>
                        <div class="text-center">
                            <button class="btn btn-danger" type="submit">Buscar</button>
                        </div>
                    </form>
                </div>
        
                <div class="card border-danger">
                    <div class="card-header">Lista de productos</div>
                    <div class="card-body px-10 py-8">
                        <div class="row">
                            <% if (searchResult && searchResult.data && searchResult.data.length > 0) { %>
                            <div class="row">
                                <% searchResult.data.forEach(function(product, index) { %>
                                <div class="col-md-6">
                                    <div class="product-box">
                                        <p>Descripción: <%= product.description %></p>
                                        <p>Clave del Producto: <%= product.product_key %></p>
                                        <p>Precio: <%= product.price %></p>
                                        <p>Impuesto Incluido: <%= product.tax_included %></p>
                                        <p>Taxabilidad: <%= product.taxability %></p>
                                        <p>Impuestos:</p>
                                        <ul>
                                            <% product.taxes.forEach(function(tax) { %>
                                                <li>Tipo de Impuesto: <%= tax.type %></li>
                                                <li>Tasa de Impuesto: <%= tax.rate %></li>
                                                <li>Base de Impuesto: <%= tax.base %></li>
                                                <li>Factor de Impuesto: <%= tax.factor %></li>
                                                <li>Retención: <%= tax.withholding %></li>
                                            <% }); %>
                                        </ul>
                                        <p>Impuestos Locales:</p>
                                        <ul>
                                            <% product.local_taxes.forEach(function(localTax) { %>
                                                <li>Tipo de Impuesto Local: <%= localTax.type %></li>
                                                <li>Tasa de Impuesto Local: <%= localTax.rate %></li>
                                                <li>Base de Impuesto Local: <%= localTax.base %></li>
                                                <li>Retención: <%= localTax.withholding %></li>
                                            <% }); %>
                                        </ul>
                                        <p>Clave de Unidad: <%= product.unit_key %></p>
                                        <p>Nombre de Unidad: <%= product.unit_name %></p>
                                        <p>SKU: <%= product.sku %></p>
                                        <div class="botones">
                                        <a href="/FacturApiEditarProductos/<%=product.id%>">
                                            <button type="button" class="btn btn-primary w-80 edit-button"><i class="fa-solid fa-pen-to-square"></i></button>
                                        </a>
                                        <a href="/FacturApiBorrarProductos/<%=product.id%>" class="trash-button-link">
                                            <button type="button" class="btn btn-dark w-80 trash-button">
                                                <i class="fa-solid fa-trash"></i> 
                                            </button>
                                        </a> 
                                    </div>
                                    </div>
                                </div>
           
                                <% if (index % 2 === 1) { %>
                                </div>
                                <div class="row">
                                <% } %>
                                <% }); %>
                            </div>
                            <% } else { %>
                            <p>No se encontró el producto.</p>
                            <% } %>

                        </div>
                    </div>
                </div>
            </div>
        </section>





    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
    <!--Multi Select-->
    <script src="https://cdn.jsdelivr.net/gh/habibmhamadi/multi-select-tag/dist/js/multi-select-tag.js"></script>

    <script src="https://kit.fontawesome.com/360b0549be.js" crossorigin="anonymous"></script>

    <script src="js/productos.js"></script>

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <!-- FontAwesome-->
    <link rel="stylesheet" href="css/mobiscroll.javascript.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="js/multiple.js"></script>
</body>

</html>
<style>
#customerForm {
    display: none;
    /* Estilos para el formulario cuando está oculto */
}


</style>
<script>
    const showFormButton = document.getElementById("showFormButton");
    const customerForm = document.getElementById("customerForm");

    showFormButton.addEventListener("click", () => {
        if (customerForm.style.display === "none") {
            customerForm.style.display = "block";
            showFormButton.textContent = "Ocultar Formulario";
        } else {
            customerForm.style.display = "none";
            showFormButton.textContent = "Mostrar Formulario";
        }
    });


    

</script>

<style>
    /* Add your custom CSS styles here */
    .product-box {
        border: 1px solid #ccc;
        padding: 10px;
        margin-bottom: 10px;
    }
    .botones{
        position: relative;
        top:-500px;
        right:-390px;
    }
</style>